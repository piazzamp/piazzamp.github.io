
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
		<title></title>
		<!-- this is an archived tumblr post published on 2015-11-15 18:02:56 -0600 CST at http://mattpiazza.com/post/133300808080/ringzer0team-challenge-113-writeup -->
  </head>
  <body>
	<p>big ups to John Anderson (lampwins) for having the curious mind and php know-how to crush this challenge in a matter of minutes – I was just along for the ride really</p>

<hr><p>this challenge came from ringzer0team.com’s set of web challenges. we have been running through them with the cyber security club for the past few weeks for an upcoming web pen-testing engagement (maybe you’ll be able to read about it here later ;) ).</p>

<p>the scenario was that you’re resetting the password to the admin console of a website (the challenge lives <a href="http://ringzer0team.com/challenges/113">here</a>). they provide the source code (php) for the password resetting mechanism. it can be summed up thusly: use the current time to seed a PRNG, grab a ‘random’ number between 1000000000000000 and 9999999999999999 to use as a password reset token. then the page will accept GETs with a url parameter <code>k</code> which is compared to the previously generated token. if they match then your new password is printed to the screen, otherwise you get nothing. there is also a 1hr expiration for each token.</p>

<p>the biggest <strong>hint</strong> for this challenge is that the current time is included in the page telling you that your password has been reset:
<img src="https://78.media.tumblr.com/c3c46ad3f18d119dd6e0356f639732f8/tumblr_inline_nxvrlzeOBk1rdmpel_540.png" alt=""/></p>

<p>[spoilers follow]</p>

<p>and we know that that time is used to seen the PRNG. once we convert that to unix time (seconds since 1 Jan 1970, UTC) we have the seed and can replicate the line  <code>$token =
        rand(1000000000000000,9999999999999999);</code> to find the token. then use that at the url parameter <code>k</code> to retrieve our new password, login, and grab the flag. cha-ching.</p>

<p>bonus: php one liner (once you have the timestamp): <code>php -r "srand(1447631726); echo rand(1000000000000000,9999999999999999);"</code></p>
  </body>
</html>
